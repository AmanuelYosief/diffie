import 'package:diffie/dhk_communication.dart';
import 'package:flutter_test/flutter_test.dart';

void main() {
  test('Generate Alice Public Key', () async {
    String alicePrivate = "387d93ad7e9afd1e7a468160e50e3ee2a31d7ad7f2db172eb6a79f28257b3b41";
    String alicePublic = DHKCommunicationChannel.generatePublicKey(alicePrivate);

    expect(alicePublic,
        "826eef5535114d9413f387b3164c023fa4fe48b1d636e1c010d53a13b7fd0a195d091b54188ffbf226e8f73e283a596ffbf03e0f94a80a36de3e199a82db13ab4bfb4457d7abcc32da741bcff6ac2473e43b2341ee2061e65964625096697603001592f756ccb3057019c4d00c1b4d5c4031acc9b6da148d917d535e7f95b9fb11cb3eff071d01962700132cb48aaccab77cc71f697e197f34599d87788a1cd9c061a840fdf156c1cb44c517c40c8ae456b7b8af342cd51d6a0976010d2b3dac56fccd226a8420bcaa1cde47b59fd876d2c2607e1f66aaa3e9a10f1a59a0e6000a463306575fae847ea5d4ace19e8ee3f8e20b5c312cb74b97ec7d86b4118c29c5192aead01df98cb765f8bdf32b336f3922c7e88f5221a3fbc0460768fdf273d0315da08db98da63d10954b2a712cf57c583877d47982f937a0055f3cd89204442a8708485c74d14f5a71fbfff79e8329aac6076b1a2225adbebc041339bd0a4714ac26f490b92aae2ea7fb9cb557fe1acf5b7c96476394896abb6fc1f0574a3cd55badc771c71b0daab6d8afb8f0c8eb8d2499b57bef3bf4e32b055cb3558492399be6caf4ac1c166f2bdd5afc921c02894890b7e1d8677865b39acea76ecb31f7ca1d9ba1300dc0c40f7c19b6742d21f6761792ee32f4eafbf0a642b70b32d9127dc2daab1bc208fb3e231f8eefce3eb244a961dc9c1daf57edabda11f181abbe696950bc2636384953381d5a96cc3ad2b97bf0fdfd56ac2de5750afd1a34317f19e4f4e1479774e943494264acc402a3fa84cc3691d1c0680db1a44bf7cc10fdf229b6342fe6ab6144a8edaa53150e7f9e5bd66fa0afb0f26b0b29b69a9bdaec4eee4cac79f6d31ed63008d65a0f55ae81a1cfded5676cd1d68712fab392c6882462eb644b5c132759bcdb9597cc3f19531243a3ce06917e60be05f53139680076327d62980ee327d057aa221bbd7aebc6751a36729a438e83572ecdb12fdc6679502d512635aa7ff44e84e2552b788a69523b0d4ea054892874a9fd4ff10e7e5d5721d4d58e738a1b479aa35f8cca1ca5ae4fcab8774f704ef6e837011200019ee19c1143e040d210050c188187b2b7f865235b1d065f2a50b355f2c8e3c3d67b64692108c28ff81e7baa043ca5317788c97a89a020797880dc5c9c967b156eee3d43d8f3b4d82340195070c165a445c7f1aecb8d3f14f831ea0b0f7e1bb7879b2c26b80737734eb4fc1de8a6fe6890e4588acee21e1c3e68a6bd2a8fcd7e136f0c65940ff5ca1a806ec0bc2f1ae5aed185857d086990411cccddc3b53674676ec5a48c921fae4e47ec76c3708f5142832a60ecce982b551de7a188a9990a6f424ee0e7c3d54bceb289de9997e41b4c20afb1dccfc7cffe883fb52e58eb50861313502beda345be9aee9bb8d4929c72b32359897993942ee7de94ff61a6");
  });

  test('Generate Bob Public Key', () async {
    String bobPrivate = "1ecf85157391cad52be428b7a867b05a1323be0c1422311072b2fdab661a036c";
    String bobPublic = DHKCommunicationChannel.generatePublicKey(bobPrivate);

    expect(bobPublic,
        "daf6c3b79429d6ee25c8154ba98c3193bdab770b2f02590cabb4513837cd85de731bdbe431a0bb7568be1bdb3d33e75af01b0a3753fd6f6fc01149999596f64919de9cfdfd3d4b35190d7c8ad40365005a1de103491a490017901e155dbfd238284b4123da27851fce69dbceff78004b21f929a67e2fc75e27e1071916b2d0e0fe6fb14a849aaa8e83de10317d6181bda4be1b339d6ebcda5e98294e74579ae3ee0d5e7a42820f5bce83aa7c024feb9d6cc0f070e6a62bbc0317c28569c64e6451f214e339f4a6d74f456d06a9df81fa36a5fe3ef083932c3c9bdd0fe14d8f88cba0abdf211c56a2b782f9fb70346d864bd35a8e5188cba21ac61efbee56782806ee0ee6d93699d60cbb7cae85dd1b138c26261e0f5eb07a053038adbcbc498fd84a9ed62b0802616fd1034c6aaae5a268ff5e96b066918b7458e9c25e5f6826747185c5e1a750c03f5948a24d3e4f3cb64971915fdaedcfe7dc2b6a05aa86c6ea6fe476f4316074499a4f5972ac14af1fb70e4bd7063b5264ad6a8d2d0a417e14fa1f9ba69bee9ee71b7770f90a34fe0485872fb5532e7a774f844f226c1d5139a8520540ca22470d96f44f214eb9ae9872f18c26f6418c9dab44fc2cf41c6768e9ad779faf100fcbe9a85caf33646cd8a55a7345c8416eebc1b10e59bc1820ac349c992eefba0252ebca2dda9757bc9c7c37c627278d4ed3a8cbb7d7777940429acd950ba67cf09c56b2467e8e25f23919f37b15015fa0f4bda30453bd2d06587b3d824d79dfde20099faa970f0879fb3639570030f01d94d3c2c7d62dad6d7cea1d7717b6a5e79157638424244cb7977763c4c92dea7c87cfacd222c2d02dc57a7a3b1cb9879d79ca2ecd89f8a89cb32ff356895bf563c9053c8c586bc3d808992dd58686a5275058e85c45b5353c91be17eb0e7c4910c6d727a76338bb3236038e44564ebb4ff6c6f633c356979251a6c0bb490eb5dcea6354a93f0c82d300d78f0ffacb93e4fb4c461ed2b5b2b94f7a91190a26341f48e389ebaa69e9f0dccef0a297c9027b207121018065c80f1062ee012c33052d4225309e0f7819ff1a4290525c4e545669693b45e69c0607850708ba9fe4c2be5d2916c0b648b4dbbb8ac8abb0f18e1d6931aa5374f22d1dbe3213974cac53950a4e5dc209efe9b5f9681d34030e1c32bf28eb7d4d1dd1f0d77986a14dcf2ce2bb3909ef63bcc1365fe35819ccb18212ced6051bc5755b259056b25ffc6038bd34e1246c59631b515c79292679e22a5f1140a04441957aa84a1f752efb1f8cdbc2cf80c14f696136409426642016b9674a1613c4d1ec610b3d4e9401459b04bbbf3690dc55a98cc93acb51753298402fbb0ac4d7757950cda3312e19508511c34a484f744f5213b700ee60848af9d57015a2758e87c0748791c22adbc34d740a0ffad40975d791f8");
  });

  test("Generate Alice Shared Key", () async {
    String alicePrivate = "387d93ad7e9afd1e7a468160e50e3ee2a31d7ad7f2db172eb6a79f28257b3b41";
    String bobPublic =
        "daf6c3b79429d6ee25c8154ba98c3193bdab770b2f02590cabb4513837cd85de731bdbe431a0bb7568be1bdb3d33e75af01b0a3753fd6f6fc01149999596f64919de9cfdfd3d4b35190d7c8ad40365005a1de103491a490017901e155dbfd238284b4123da27851fce69dbceff78004b21f929a67e2fc75e27e1071916b2d0e0fe6fb14a849aaa8e83de10317d6181bda4be1b339d6ebcda5e98294e74579ae3ee0d5e7a42820f5bce83aa7c024feb9d6cc0f070e6a62bbc0317c28569c64e6451f214e339f4a6d74f456d06a9df81fa36a5fe3ef083932c3c9bdd0fe14d8f88cba0abdf211c56a2b782f9fb70346d864bd35a8e5188cba21ac61efbee56782806ee0ee6d93699d60cbb7cae85dd1b138c26261e0f5eb07a053038adbcbc498fd84a9ed62b0802616fd1034c6aaae5a268ff5e96b066918b7458e9c25e5f6826747185c5e1a750c03f5948a24d3e4f3cb64971915fdaedcfe7dc2b6a05aa86c6ea6fe476f4316074499a4f5972ac14af1fb70e4bd7063b5264ad6a8d2d0a417e14fa1f9ba69bee9ee71b7770f90a34fe0485872fb5532e7a774f844f226c1d5139a8520540ca22470d96f44f214eb9ae9872f18c26f6418c9dab44fc2cf41c6768e9ad779faf100fcbe9a85caf33646cd8a55a7345c8416eebc1b10e59bc1820ac349c992eefba0252ebca2dda9757bc9c7c37c627278d4ed3a8cbb7d7777940429acd950ba67cf09c56b2467e8e25f23919f37b15015fa0f4bda30453bd2d06587b3d824d79dfde20099faa970f0879fb3639570030f01d94d3c2c7d62dad6d7cea1d7717b6a5e79157638424244cb7977763c4c92dea7c87cfacd222c2d02dc57a7a3b1cb9879d79ca2ecd89f8a89cb32ff356895bf563c9053c8c586bc3d808992dd58686a5275058e85c45b5353c91be17eb0e7c4910c6d727a76338bb3236038e44564ebb4ff6c6f633c356979251a6c0bb490eb5dcea6354a93f0c82d300d78f0ffacb93e4fb4c461ed2b5b2b94f7a91190a26341f48e389ebaa69e9f0dccef0a297c9027b207121018065c80f1062ee012c33052d4225309e0f7819ff1a4290525c4e545669693b45e69c0607850708ba9fe4c2be5d2916c0b648b4dbbb8ac8abb0f18e1d6931aa5374f22d1dbe3213974cac53950a4e5dc209efe9b5f9681d34030e1c32bf28eb7d4d1dd1f0d77986a14dcf2ce2bb3909ef63bcc1365fe35819ccb18212ced6051bc5755b259056b25ffc6038bd34e1246c59631b515c79292679e22a5f1140a04441957aa84a1f752efb1f8cdbc2cf80c14f696136409426642016b9674a1613c4d1ec610b3d4e9401459b04bbbf3690dc55a98cc93acb51753298402fbb0ac4d7757950cda3312e19508511c34a484f744f5213b700ee60848af9d57015a2758e87c0748791c22adbc34d740a0ffad40975d791f8";
    String calculateAliceSharedKey = DHKCommunicationChannel.calculateSharedKey(bobPublic, alicePrivate);

    expect(calculateAliceSharedKey,
        "25cf4cc4e14552fccf060b6384be4b6271b51c8105f4e53e142a0579c16cfa7041cbfe205c0a0196e7e93b3349c30d19e3bfd7ada4598edaec1032fcce0367d47fabc893b49c65705a1e4f0d332ddc03ecfaf581e9de41811fc50e5cfe1d695a7c149c372a1d0672e3537fa4a92cc41ead75feb275a7c0309000d83878ffb5adc39aae402f1a8ee36205e6cbb813870f3a07be40414c28a878d3347d9eb1644baf8450c25e528aebe28e635884cd2546fb5bda1c1a9fc4edd7e9539e3900da14c8c962a1f87f4a1a69e4d606c2475bc191399b3b9e2e6beb1a0cc4dbd99f3476f92fef3bc6bd210d5e3275ed9bdcb8d9891f07d53fecc6c12e7af0a08a454d6814a418ccb0ca61ca80e989cc6d046dda7dcbe4019b6b0020dbc6ddeaa1930e84d1570bc12cae8ec41b2aae58a131e057e7cabbcf966cdf7c76900ac31604cdba5b77c5f205fbd8df0a320e6204ee986228195002be4a13814f57db6053e3bdaa06b911bbb5dae5136978341e1f6455a09dd01a12505a1c0d87ee631a7ffc1fb95c897c1b5ad57259452e38eaaaa476e69bfa8aa832c01e86bc2b4e0ed118faf5d6e13f368ce61eae9d21401ad69e15bb76965a8a8ac86a11fae8f3ebbbf41a4ed694b0f10ad8fa89f10e8d749d9da8969e5f264104a57fa8dc7a9a5422b1f013e579a2e43e2d5600d288d4f6f9cbb60bd77e7f34247dae1a709a765258683f1c228a5c768f5868f57cb7407a764fd893ac5b9195edd6a1acf14d0b2f0bae923b0f3703df8737e38cf06d891f55a372771e9504d9a0db0aa7110804ca6e956e1300257c5318af88f69b616f91878a1abec2d14e843819d6c65c5d249b4bdea8fe69f9464c22289a69c8d104fa631b6c6924840d903f1f31ba4b69908c971721b0dba95d6f444d077be5f685f9910728dc523f32b76ddb7b1d2aec82edaebe9fbdaa8c430de14376fc518fe0949a67789d3e2576612d1064ef44c73b960e836c2486bfa75d58bf392ec2d27a2c3015b70ca97f1907eebbd1b44af9fa08b6a5b782fbc562816aa753bf598e4ee4d7277734a08cc035fd4ab7317a67ea92e526d3decbdc5fa9de8c28ceea3398d2640e7d6669cce2b6df7f57488cf752534fc35c11622bba5c0ce9aa42ace609406e422d279a695b7c345ad8d758976d13451bebf630826aaa0dd152ed8cb6bfde2565f76db28d8a07aff9987e7690f171ca21c53f5ec04e9ff88874d4f49f0d04328dcace2c2d7aebe81927e7b83e14eee004855115c0f23df7b71ef84fe638f2427a97319911ca48e5ba88d6b6c09fe332de0a327ac68d37134d5c0b6ed069ca0abbca07bb081c700d72f171c2122c19c8309a935abbddbf3fb9c941d34c8005549c8215b5a6a72d01c258c40a30ccbb62c84662794858aab0b38f935f2e09418f9f218fc3fd8bfc0df3cd5776749a2f2f1b9ed2");
  });

  test("Generate Bob Shared Key", () async {
    String bobPrivate = "1ecf85157391cad52be428b7a867b05a1323be0c1422311072b2fdab661a036c";
    String alicePublic =
        "826eef5535114d9413f387b3164c023fa4fe48b1d636e1c010d53a13b7fd0a195d091b54188ffbf226e8f73e283a596ffbf03e0f94a80a36de3e199a82db13ab4bfb4457d7abcc32da741bcff6ac2473e43b2341ee2061e65964625096697603001592f756ccb3057019c4d00c1b4d5c4031acc9b6da148d917d535e7f95b9fb11cb3eff071d01962700132cb48aaccab77cc71f697e197f34599d87788a1cd9c061a840fdf156c1cb44c517c40c8ae456b7b8af342cd51d6a0976010d2b3dac56fccd226a8420bcaa1cde47b59fd876d2c2607e1f66aaa3e9a10f1a59a0e6000a463306575fae847ea5d4ace19e8ee3f8e20b5c312cb74b97ec7d86b4118c29c5192aead01df98cb765f8bdf32b336f3922c7e88f5221a3fbc0460768fdf273d0315da08db98da63d10954b2a712cf57c583877d47982f937a0055f3cd89204442a8708485c74d14f5a71fbfff79e8329aac6076b1a2225adbebc041339bd0a4714ac26f490b92aae2ea7fb9cb557fe1acf5b7c96476394896abb6fc1f0574a3cd55badc771c71b0daab6d8afb8f0c8eb8d2499b57bef3bf4e32b055cb3558492399be6caf4ac1c166f2bdd5afc921c02894890b7e1d8677865b39acea76ecb31f7ca1d9ba1300dc0c40f7c19b6742d21f6761792ee32f4eafbf0a642b70b32d9127dc2daab1bc208fb3e231f8eefce3eb244a961dc9c1daf57edabda11f181abbe696950bc2636384953381d5a96cc3ad2b97bf0fdfd56ac2de5750afd1a34317f19e4f4e1479774e943494264acc402a3fa84cc3691d1c0680db1a44bf7cc10fdf229b6342fe6ab6144a8edaa53150e7f9e5bd66fa0afb0f26b0b29b69a9bdaec4eee4cac79f6d31ed63008d65a0f55ae81a1cfded5676cd1d68712fab392c6882462eb644b5c132759bcdb9597cc3f19531243a3ce06917e60be05f53139680076327d62980ee327d057aa221bbd7aebc6751a36729a438e83572ecdb12fdc6679502d512635aa7ff44e84e2552b788a69523b0d4ea054892874a9fd4ff10e7e5d5721d4d58e738a1b479aa35f8cca1ca5ae4fcab8774f704ef6e837011200019ee19c1143e040d210050c188187b2b7f865235b1d065f2a50b355f2c8e3c3d67b64692108c28ff81e7baa043ca5317788c97a89a020797880dc5c9c967b156eee3d43d8f3b4d82340195070c165a445c7f1aecb8d3f14f831ea0b0f7e1bb7879b2c26b80737734eb4fc1de8a6fe6890e4588acee21e1c3e68a6bd2a8fcd7e136f0c65940ff5ca1a806ec0bc2f1ae5aed185857d086990411cccddc3b53674676ec5a48c921fae4e47ec76c3708f5142832a60ecce982b551de7a188a9990a6f424ee0e7c3d54bceb289de9997e41b4c20afb1dccfc7cffe883fb52e58eb50861313502beda345be9aee9bb8d4929c72b32359897993942ee7de94ff61a6";
    String calculateBobSharedKey = DHKCommunicationChannel.calculateSharedKey(alicePublic, bobPrivate);
    expect(calculateBobSharedKey,
        "25cf4cc4e14552fccf060b6384be4b6271b51c8105f4e53e142a0579c16cfa7041cbfe205c0a0196e7e93b3349c30d19e3bfd7ada4598edaec1032fcce0367d47fabc893b49c65705a1e4f0d332ddc03ecfaf581e9de41811fc50e5cfe1d695a7c149c372a1d0672e3537fa4a92cc41ead75feb275a7c0309000d83878ffb5adc39aae402f1a8ee36205e6cbb813870f3a07be40414c28a878d3347d9eb1644baf8450c25e528aebe28e635884cd2546fb5bda1c1a9fc4edd7e9539e3900da14c8c962a1f87f4a1a69e4d606c2475bc191399b3b9e2e6beb1a0cc4dbd99f3476f92fef3bc6bd210d5e3275ed9bdcb8d9891f07d53fecc6c12e7af0a08a454d6814a418ccb0ca61ca80e989cc6d046dda7dcbe4019b6b0020dbc6ddeaa1930e84d1570bc12cae8ec41b2aae58a131e057e7cabbcf966cdf7c76900ac31604cdba5b77c5f205fbd8df0a320e6204ee986228195002be4a13814f57db6053e3bdaa06b911bbb5dae5136978341e1f6455a09dd01a12505a1c0d87ee631a7ffc1fb95c897c1b5ad57259452e38eaaaa476e69bfa8aa832c01e86bc2b4e0ed118faf5d6e13f368ce61eae9d21401ad69e15bb76965a8a8ac86a11fae8f3ebbbf41a4ed694b0f10ad8fa89f10e8d749d9da8969e5f264104a57fa8dc7a9a5422b1f013e579a2e43e2d5600d288d4f6f9cbb60bd77e7f34247dae1a709a765258683f1c228a5c768f5868f57cb7407a764fd893ac5b9195edd6a1acf14d0b2f0bae923b0f3703df8737e38cf06d891f55a372771e9504d9a0db0aa7110804ca6e956e1300257c5318af88f69b616f91878a1abec2d14e843819d6c65c5d249b4bdea8fe69f9464c22289a69c8d104fa631b6c6924840d903f1f31ba4b69908c971721b0dba95d6f444d077be5f685f9910728dc523f32b76ddb7b1d2aec82edaebe9fbdaa8c430de14376fc518fe0949a67789d3e2576612d1064ef44c73b960e836c2486bfa75d58bf392ec2d27a2c3015b70ca97f1907eebbd1b44af9fa08b6a5b782fbc562816aa753bf598e4ee4d7277734a08cc035fd4ab7317a67ea92e526d3decbdc5fa9de8c28ceea3398d2640e7d6669cce2b6df7f57488cf752534fc35c11622bba5c0ce9aa42ace609406e422d279a695b7c345ad8d758976d13451bebf630826aaa0dd152ed8cb6bfde2565f76db28d8a07aff9987e7690f171ca21c53f5ec04e9ff88874d4f49f0d04328dcace2c2d7aebe81927e7b83e14eee004855115c0f23df7b71ef84fe638f2427a97319911ca48e5ba88d6b6c09fe332de0a327ac68d37134d5c0b6ed069ca0abbca07bb081c700d72f171c2122c19c8309a935abbddbf3fb9c941d34c8005549c8215b5a6a72d01c258c40a30ccbb62c84662794858aab0b38f935f2e09418f9f218fc3fd8bfc0df3cd5776749a2f2f1b9ed2");
  });

  test("Verify shared key match", () async {
    String alicePrivate = "387d93ad7e9afd1e7a468160e50e3ee2a31d7ad7f2db172eb6a79f28257b3b41";
    String alicePublic = DHKCommunicationChannel.generatePublicKey(alicePrivate);

    String bobPrivate = "1ecf85157391cad52be428b7a867b05a1323be0c1422311072b2fdab661a036c";
    String bobPublic = DHKCommunicationChannel.generatePublicKey(bobPrivate);

    String calculateAliceSharedKey = DHKCommunicationChannel.calculateSharedKey(bobPublic, alicePrivate);
    String calculateBobSharedKey = DHKCommunicationChannel.calculateSharedKey(alicePublic, bobPrivate);

    expect(true, calculateAliceSharedKey == calculateBobSharedKey);
  });
}
